# Aeryn-Deutsch AIå¯¹è¯ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

### è®¾è®¡ç†å¿µ
- **å…è´¹åŸºç¡€**: æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½ä½¿ç”¨åŸºç¡€å¯¹è¯åŠŸèƒ½
- **ä»˜è´¹å‡çº§**: é«˜çº§AIæ¥å£ä¾›è®¢é˜…ç”¨æˆ·ä½¿ç”¨
- **éšç§ä¼˜å…ˆ**: æœ¬åœ°å¤„ç†ä¸ºä¸»ï¼Œå¯é€‰äº‘ç«¯AI
- **ç¦»çº¿å‹å¥½**: æ ¸å¿ƒåŠŸèƒ½æ”¯æŒç¦»çº¿ä½¿ç”¨

### æ¶æ„æ¨¡å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·ç•Œé¢å±‚ (UI)              â”‚
â”‚  - å¯¹è¯åœºæ™¯é€‰æ‹©                      â”‚
â”‚  - å®æ—¶å¯¹è¯ç•Œé¢                      â”‚
â”‚  - è¯­éŸ³è¾“å…¥/è¾“å‡º                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AIå¯¹è¯å¼•æ“ç®¡ç†å±‚                â”‚
â”‚  - åœºæ™¯ç®¡ç†å™¨                        â”‚
â”‚  - å¯¹è¯çŠ¶æ€è¿½è¸ª                      â”‚
â”‚  - é”™è¯¯å¤„ç†                          â”‚
â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚               â”‚
  â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ¬åœ°å¼•æ“    â”‚ â”‚   äº‘ç«¯APIå¼•æ“    â”‚
â”‚ (å…è´¹)      â”‚ â”‚   (ä»˜è´¹è®¢é˜…)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è§„åˆ™ç³»ç»Ÿ  â”‚ â”‚ â€¢ OpenAI GPT-4   â”‚
â”‚ â€¢ æ¨¡æ¿å¯¹è¯  â”‚ â”‚ â€¢ Claude Opus    â”‚
â”‚ â€¢ åœºæ™¯è„šæœ¬  â”‚ â”‚ â€¢ Gemini Pro     â”‚
â”‚ â€¢ é¢„è®¾å“åº”  â”‚ â”‚ â€¢ å¾·è¯­ä¸“ç”¨æ¨¡å‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ†“ å…è´¹AIå¼•æ“ (æœ¬åœ°)

### 1. è§„åˆ™å¯¹è¯ç³»ç»Ÿ (Rule-Based)

**åŸç†**: åŸºäºé¢„å®šä¹‰è§„åˆ™å’Œæ¨¡å¼åŒ¹é…

**ä¼˜ç‚¹**:
- âœ… å®Œå…¨å…è´¹
- âœ… 100%ç¦»çº¿
- âœ… å“åº”å¿«é€Ÿ
- âœ… éšç§å®‰å…¨
- âœ… å¯é¢„æµ‹æ€§å¼º

**é€‚ç”¨åœºæ™¯**:
- ç®€å•é—®ç­”
- å›ºå®šå¯¹è¯ç»ƒä¹ 
- è¯­æ³•çº æ­£
- è¯æ±‡å¤ä¹ 

**æŠ€æœ¯å®ç°**:
```dart
class RuleBasedAIEngine {
  // 1. æ„å›¾è¯†åˆ«
  Intent recognizeIntent(String userInput);

  // 2. å®ä½“æå–
  Map<String, String> extractEntities(String userInput);

  // 3. å“åº”ç”Ÿæˆ
  String generateResponse(Intent intent, Map<String, String> entities);

  // 4. ä¸Šä¸‹æ–‡ç®¡ç†
  void updateContext(ConversationContext context);
}
```

### 2. åœºæ™¯å¯¹è¯ (Scenario-Based)

**é¢„è®¾è®¡åœºæ™¯**:
1. **æ—¥å¸¸å¯¹è¯** (Alltag)
   - è‡ªæˆ‘ä»‹ç»
   - é—®å€™å’Œå‘Šåˆ«
   - è¡¨è¾¾å–œå¥½
   - æ—¥å¸¸å®‰æ’

2. **è´­ç‰©åœºæ™¯** (Einkaufen)
   - è¯¢é—®ä»·æ ¼
   - è®¨è®ºå•†å“
   - ç ä»·å¯¹è¯
   - æ”¯ä»˜æ–¹å¼

3. **é¤å…åœºæ™¯** (Im Restaurant)
   - é¢„è®¢åº§ä½
   - ç‚¹é¤
   - æŠ•è¯‰ä¸å»ºè®®
   - ç»“è´¦

4. **æ—…è¡Œåœºæ™¯** (Reisen)
   - è¯¢é—®è·¯çº¿
   - è´­ä¹°ç¥¨åŠ¡
   - é…’åº—å…¥ä½
   - æ±‚åŠ©

5. **å·¥ä½œåœºæ™¯** (Beruf)
   - é¢è¯•å‡†å¤‡
   - ä¼šè®®è®¨è®º
   - é‚®ä»¶å†™ä½œ
   - ç”µè¯æ²Ÿé€š

6. **å­¦æœ¯åœºæ™¯** (Studium)
   - è¯¾å ‚è®¨è®º
   - è®ºæ–‡æŒ‡å¯¼
   - å­¦æœ¯äº¤æµ

**å¯¹è¯æµç¨‹**:
```dart
class ScenarioDialogue {
  final String scenarioId;
  final String level;  // A1, A2, B1, B2, C1, C2
  final List<DialogueStage> stages;

  // åŠ¨æ€éš¾åº¦è°ƒæ•´
  DialogueStage getCurrentStage();
  void provideHint();
  void skipToNext();
}
```

### 3. æ¨¡æ¿å“åº” (Template Responses)

**å“åº”æ¨¡æ¿ç³»ç»Ÿ**:
```dart
const Map<String, List<String>> responseTemplates = {
  'greeting': [
    'Hallo! Wie kann ich Ihnen helfen?',
    'Guten Tag! Was mÃ¶chten Sie besprechen?',
    'Willkommen! Wie geht es Ihnen?',
  ],
  'grammar_correction': [
    'Fast richtig! Besser wÃ¤re: "{correction}"',
    'Guter Versuch. Die korrekte Form ist: "{correction}"',
    'Nicht schlecht. Aber man sagt: "{correction}"',
  ],
  'encouragement': [
    'Sehr gut! Machen Sie so weiter!',
    'Ausgezeichnet! Ihr Deutsch verbessert sich.',
    'Toll! Das haben Sie gut gemacht.',
  ],
};
```

### 4. è¯­æ³•çº æ­£å¼•æ“

**é›†æˆè¯­æ³•æ£€æŸ¥å™¨**:
```dart
class GrammarCorrectionBot {
  Future<String> processInput(String userInput) async {
    // 1. æ£€æŸ¥è¯­æ³•é”™è¯¯
    final result = await EnhancedGermanGrammarRules.checkGrammarEnhanced(userInput);

    // 2. å¦‚æœæœ‰é”™è¯¯ï¼Œæä¾›çº æ­£
    if (result.errors.isNotEmpty) {
      return generateCorrection(userInput, result.errors.first);
    }

    // 3. å¦‚æœæ­£ç¡®ï¼Œç»§ç»­å¯¹è¯
    return generateResponse(userInput);
  }

  String generateCorrection(String original, GrammarError error) {
    return 'Sie sagten: "$original"\n'
        'Besser: "${error.correctedText}"\n'
        'ErklÃ¤rung: ${error.explanation}';
  }
}
```

---

## ğŸ’ ä»˜è´¹AIå¼•æ“ (äº‘ç«¯API)

### æ”¯æŒçš„AIæœåŠ¡

#### 1. OpenAI GPT-4
**é…ç½®**:
```dart
class OpenAIConfig {
  final String apiKey;
  final String model = 'gpt-4-turbo-preview';
  final String baseUrl = 'https://api.openai.com/v1';
  final Map<String, dynamic> parameters = {
    'temperature': 0.7,
    'max_tokens': 500,
    'top_p': 0.9,
  };
}
```

**å¾·è¯­ä¼˜åŒ–**:
- System promptä¼˜åŒ–ä¸ºå¾·è¯­å¯¹è¯
- æ·»åŠ å¾·è¯­è¯­æ³•çŸ¥è¯†
- æ–‡åŒ–èƒŒæ™¯ç†è§£

#### 2. Anthropic Claude
**é…ç½®**:
```dart
class ClaudeConfig {
  final String apiKey;
  final String model = 'claude-3-opus-20240229';
  final String baseUrl = 'https://api.anthropic.com/v1';
  final Map<String, dynamic> parameters = {
    'temperature': 0.7,
    'max_tokens': 1000,
    'top_k': 250,
  };
}
```

**ä¼˜åŠ¿**:
- æ›´é•¿çš„ä¸Šä¸‹æ–‡çª—å£ (200K tokens)
- æ›´å¥½çš„å¤šè¯­è¨€æ”¯æŒ
- æ›´å®‰å…¨çš„è¾“å‡º

#### 3. Google Gemini
**é…ç½®**:
```dart
class GeminiConfig {
  final String apiKey;
  final String model = 'gemini-pro';
  final String baseUrl = 'https://generativelanguage.googleapis.com/v1';
  final Map<String, dynamic> parameters = {
    'temperature': 0.7,
    'maxOutputTokens': 1000,
    'topP': 0.9,
    'topK': 40,
  };
}
```

**ä¼˜åŠ¿**:
- Googleå¼ºå¤§çš„å¤šè¯­è¨€èƒ½åŠ›
- å®æ—¶ç½‘ç»œä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
- æ›´å…·æ€§ä»·æ¯”

#### 4. å¾·è¯­ä¸“ç”¨æ¨¡å‹

**æ¨è**:
- **Aleph Alpha** (å¾·å›½AIå…¬å¸)
- **Hugging Face** å¾·è¯­æ¨¡å‹
- **EUåˆè§„** çš„æ¨¡å‹é€‰é¡¹

```dart
class GermanAIModel {
  final String provider = 'Aleph Alpha';
  final String model = 'luminous-supreme';
  final bool isGDPRCompliant = true;
  final bool serversInEU = true;
}
```

---

## ğŸ”§ æ··åˆå¼•æ“æ¶æ„

### è‡ªåŠ¨é™çº§ç­–ç•¥

```dart
class HybridAIEngine {
  Future<String> generateResponse(String userInput) async {
    // 1. æ£€æŸ¥ç”¨æˆ·è®¢é˜…çŠ¶æ€
    final hasPremium = await UserService.hasPremiumSubscription();

    if (hasPremium) {
      try {
        // 2. å°è¯•ä½¿ç”¨é«˜çº§AI
        return await _callPremiumAI(userInput);
      } catch (e) {
        // 3. å¦‚æœå¤±è´¥ï¼Œé™çº§åˆ°æœ¬åœ°å¼•æ“
        debugPrint('Premium AI failed, falling back to local: $e');
        return _callLocalEngine(userInput);
      }
    } else {
      // 4. å…è´¹ç”¨æˆ·ä½¿ç”¨æœ¬åœ°å¼•æ“
      return _callLocalEngine(userInput);
    }
  }

  Future<String> _callPremiumAI(String input) async {
    final provider = await UserService.getSelectedAIProvider();
    switch (provider) {
      case AIProvider.openai:
        return await OpenAIService.chat(input);
      case AIProvider.claude:
        return await ClaudeService.chat(input);
      case AIProvider.gemini:
        return await GeminiService.chat(input);
      default:
        throw UnimplementedError();
    }
  }

  String _callLocalEngine(String input) {
    return RuleBasedAIEngine.process(input);
  }
}
```

### APIé…ç½®ç®¡ç†

```dart
class AIServiceConfig {
  // OpenAIé…ç½®
  static String? openaiApiKey;
  static bool openaiEnabled = false;

  // Claudeé…ç½®
  static String? claudeApiKey;
  static bool claudeEnabled = false;

  // Geminié…ç½®
  static String? geminiApiKey;
  static bool geminiEnabled = false;

  // åŠ è½½é…ç½®
  static Future<void> loadConfig() async {
    final prefs = await SharedPreferences.getInstance();
    openaiApiKey = prefs.getString('openai_api_key');
    openaiEnabled = prefs.getBool('openai_enabled') ?? false;
    // ... å…¶ä»–é…ç½®
  }

  // ä¿å­˜é…ç½®
  static Future<void> saveConfig(String provider, String apiKey) async {
    final prefs = await SharedPreferences.getInstance();
    switch (provider) {
      case 'openai':
        openaiApiKey = apiKey;
        openaiEnabled = true;
        await prefs.setString('openai_api_key', apiKey);
        await prefs.setBool('openai_enabled', true);
        break;
      // ... å…¶ä»–provider
    }
  }

  // æ£€æŸ¥æ˜¯å¦é…ç½®
  static bool isConfigured(String provider) {
    switch (provider) {
      case 'openai': return openaiEnabled && openaiApiKey != null;
      case 'claude': return claudeEnabled && claudeApiKey != null;
      case 'gemini': return geminiEnabled && geminiApiKey != null;
      default: return false;
    }
  }
}
```

---

## ğŸ“± ç”¨æˆ·ç•Œé¢è®¾è®¡

### å¯¹è¯åœºæ™¯é€‰æ‹©

```dart
class ScenarioSelectionScreen extends StatelessWidget {
  final scenarios = [
    Scenario(
      id: 'daily_greeting',
      name: 'æ—¥å¸¸é—®å€™',
      level: 'A1',
      icon: Icons.waving_hand,
      color: Colors.blue,
    ),
    Scenario(
      id: 'shopping',
      name: 'è´­ç‰©',
      level: 'A2',
      icon: Icons.shopping_cart,
      color: Colors.green,
    ),
    Scenario(
      id: 'restaurant',
      name: 'é¤å…',
      level: 'B1',
      icon: Icons.restaurant,
      color: Colors.orange,
    ),
    Scenario(
      id: 'job_interview',
      name: 'æ±‚èŒé¢è¯•',
      level: 'B2',
      icon: Icons.work,
      color: Colors.purple,
    ),
  ];
}
```

### å¯¹è¯ç•Œé¢

```dart
class ConversationScreen extends StatefulWidget {
  @override
  _ConversationScreenState createState() => _ConversationScreenState();
}

class _ConversationScreenState extends State<ConversationScreen> {
  final List<ChatMessage> messages = [];
  final TextEditingController textController = TextEditingController();
  bool isPremiumUser = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('å¾·è¯­å¯¹è¯ç»ƒä¹ '),
        actions: [
          // AIå¼•æ“æŒ‡ç¤ºå™¨
          if (isPremiumUser)
            Icon(Icons.auto_awesome, color: Colors.amber),
          IconButton(
            icon: Icon(Icons.settings),
            onPressed: () => _showAIConfig(),
          ),
        ],
      ),
      body: Column(
        children: [
          // å¯¹è¯å†å²
          Expanded(
            child: ListView.builder(
              itemCount: messages.length,
              itemBuilder: (context, index) {
                return ChatBubble(message: messages[index]);
              },
            ),
          ),
          // è¾“å…¥æ¡†
          _buildInputArea(),
          // è¯­éŸ³æŒ‰é’®
          _buildVoiceButton(),
        ],
      ),
    );
  }
}
```

---

## ğŸ’° è®¢é˜…é›†æˆ

### å…è´¹åŠŸèƒ½
- âœ… è§„åˆ™å¯¹è¯ç³»ç»Ÿ
- âœ… 10ä¸ªé¢„è®¾åœºæ™¯
- âœ… åŸºç¡€è¯­æ³•çº æ­£
- âœ… æ–‡å­—å¯¹è¯

### ä»˜è´¹åŠŸèƒ½ (â‚¬10/æœˆ æˆ– â‚¬70/å¹´)
- âœ… é«˜çº§AIå¯¹è¯ (GPT-4/Claude/Gemini)
- âœ… æ— é™å¯¹è¯æ¬¡æ•°
- âœ… è¯­éŸ³è¾“å…¥/è¾“å‡º
- âœ… è‡ªå®šä¹‰åœºæ™¯
- âœ… å¯¹è¯å†å²ä¿å­˜
- âœ… è¿›åº¦æŠ¥å‘Š

### APIé…ç½®ç•Œé¢

```dart
class AIConfigScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('AIè®¾ç½®')),
      body: ListView(
        children: [
          _buildProviderCard(
            name: 'OpenAI GPT-4',
            description: 'æœ€å¼ºå¤§çš„è¯­è¨€æ¨¡å‹',
            icon: 'assets/openai.png',
            isConfigured: AIServiceConfig.isConfigured('openai'),
            onTap: () => _showAPIKeyDialog('openai'),
          ),
          _buildProviderCard(
            name: 'Claude',
            description: 'Anthropicçš„AIåŠ©æ‰‹',
            icon: 'assets/claude.png',
            isConfigured: AIServiceConfig.isConfigured('claude'),
            onTap: () => _showAPIKeyDialog('claude'),
          ),
          _buildProviderCard(
            name: 'Gemini',
            description: 'Googleçš„AIæ¨¡å‹',
            icon: 'assets/gemini.png',
            isConfigured: AIServiceConfig.isConfigured('gemini'),
            onTap: () => _showAPIKeyDialog('gemini'),
          ),
        ],
      ),
    );
  }
}
```

---

## ğŸ” éšç§ä¸å®‰å…¨

### æ•°æ®å¤„ç†

**æœ¬åœ°å¼•æ“**:
- âœ… æ‰€æœ‰æ•°æ®æœ¬åœ°å¤„ç†
- âœ… ä¸éœ€è¦ç½‘ç»œè¿æ¥
- âœ… ç¬¦åˆGDPR
- âœ… é›¶æ•°æ®æ”¶é›†

**äº‘ç«¯å¼•æ“**:
- âš ï¸ å‘é€åˆ°ç¬¬ä¸‰æ–¹API
- âœ… æä¾›æ¸…æ™°çš„éšç§æ”¿ç­–
- âœ… å¯é€‰æ‹©åŒ¿åæ¨¡å¼
- âœ… ä¸ä¿å­˜å¯¹è¯å†å²ï¼ˆé™¤éç”¨æˆ·åŒæ„ï¼‰

### APIå¯†é’¥å®‰å…¨

```dart
class SecureStorage {
  static const secureKey = 'aeryn_secure_storage';

  static Future<void> saveAPIKey(String provider, String key) async {
    final storage = await FlutterSecureStorage();
    await storage.write(key: '${provider}_api_key', value: key);
  }

  static Future<String?> getAPIKey(String provider) async {
    final storage = await FlutterSecureStorage();
    return await storage.read(key: '${provider}_api_key');
  }

  static Future<void> deleteAPIKey(String provider) async {
    final storage = await FlutterSecureStorage();
    await storage.delete(key: '${provider}_api_key');
  }
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å“åº”æ—¶é—´ç›®æ ‡
- æœ¬åœ°å¼•æ“: < 100ms
- äº‘ç«¯å¼•æ“: < 2s
- è¯­éŸ³è¯†åˆ«: < 1s
- è¯­éŸ³åˆæˆ: < 1s

### ç¼“å­˜ç­–ç•¥
```dart
class ResponseCache {
  static final cache = <String, CachedResponse>{};

  static Future<String> getCachedResponse(String input) async {
    final cached = cache[input];
    if (cached != null && !cached.isExpired) {
      return cached.response;
    }
    return null;
  }

  static void cacheResponse(String input, String response) {
    cache[input] = CachedResponse(
      response: response,
      timestamp: DateTime.now(),
      ttl: Duration(hours: 24),
    );
  }
}
```

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€ç³»ç»Ÿ (Week 1-2)
- [x] è§„åˆ™å¯¹è¯å¼•æ“
- [x] åœºæ™¯å¯¹è¯æ¡†æ¶
- [ ] UIç•Œé¢å®ç°
- [ ] åŸºç¡€æµ‹è¯•

### Phase 2: é«˜çº§åŠŸèƒ½ (Week 3-4)
- [ ] OpenAIé›†æˆ
- [ ] Claudeé›†æˆ
- [ ] Geminié›†æˆ
- [ ] APIé…ç½®ç®¡ç†

### Phase 3: è¯­éŸ³åŠŸèƒ½ (Week 5-6)
- [ ] è¯­éŸ³è¯†åˆ« (STT)
- [ ] è¯­éŸ³åˆæˆ (TTS)
- [ ] å‘éŸ³è¯„åˆ†

### Phase 4: ä¼˜åŒ–ä¸å‘å¸ƒ (Week 7-8)
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] æ–‡æ¡£å®Œå–„
- [ ] æµ‹è¯•ä¸å‘å¸ƒ

---

**æœ€åæ›´æ–°**: 2026-02-08
**çŠ¶æ€**: è®¾è®¡å®Œæˆï¼Œå¼€å§‹å®æ–½
